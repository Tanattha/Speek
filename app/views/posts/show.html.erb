<div class="container container-body py-5 px-4">
  <div class="card-group">
    <%= render partial: "users/user_card", locals: {user: @post.user} %>
    <div class="col-xl-8">
      <section class="my-4">
        <!-- Card header -->
        <div class="card-header border-0 font-weight-bold d-flex justify-content-between">
          <p class="mr-4 mb-0">
            Posted <%= @post.created_at.strftime("%B %e at %H:%M") %>
            <% if @post.community %>
              in <%= link_to @post.community.name, community_post_path(@post.community, @post) %>
            <% elsif @post.parent_id %>
              as reply to <%= link_to @post.parent.user.username, user_post_path(@post.parent.user, @post.parent) %>
            <% else %>
              in Global
            <% end %>
          </p>
          <ul class="list-unstyled list-inline mb-0">
            <li class="list-inline-item"><a href="" class="mr-3"><i class="fas fa-envelope mr-1"></i>Send message</a></li>
            <li class="list-inline-item"><a href="" class="mr-3"><i class="fas fa-at mr-1"></i>Follow</a></li>
          </ul>
        </div>
        <div class="media mt-4 px-1 text-md-left border-1">
          <% if @post.user.avatar.presence %>
            <%= image_tag @post.user.avatar.variant(resize_to_limit: [80, 80]), class: "card-img-80 d-flex rounded-circle z-depth-1 mr-3" %>
          <% else %>
            <img class="card-img-100 d-flex z-depth-1 mr-3" src="https://mdbootstrap.com/img/Photos/Avatars/img%20(8).jpg" alt="Generic placeholder image">
          <% end %>
          <div class="media-body">
            <h5 class="font-weight-bold mt-0 mb-0 text-muted">
              <%= link_to @post.user.name, user_post_path(@post.user, @post) %><small class="text-muted align-middle pl-2">@<%= link_to @post.user.username, user_post_path(@post.user, @post) %></small>
            </h5>
            <p class="mt-2"><%= raw(@post.parsed_body) %></p>
            <div class="row" style="background: #f9f9f9; padding-top: 5px; padding-bottom: 5px; margin-left: 1px; margin-right: 1px;">
              <small class="blue-grey-text pl-3">
                Posted <%= @post.created_at.strftime("%B %e at %H:%M") %>
                <% if @post.parent_id %>
                  as reply to <%= link_to post.parent.user.username, user_post_path(@post.parent.user, @post.parent) %><a href="#modalPostForm" class="pl-3" data-toggle="modal" data-id="<%= @post.id %>"><i class="fas fa-comment-dots"></i> Reply</a><a class="pl-3"><i class="fas fa-quote-right"></i> Repost</a>
                  <%= link_to "View post", user_post_path(@post.user, @post), class: "pl-2" %>
                  <%= link_to user_post_path(@post.user, post), class: "pl-2" do %>
                    <i class="fas fa-trash-alt"></i>
                  <% end %>
                <% elsif @post.community %>
                  in <%= link_to @post.community.name, community_path(@post.community) %><a href="#modalPostForm" class="pl-3" data-toggle="modal" data-id="<%= @post.id %>"><i class="fas fa-comment-dots"></i> Reply</a><a class="pl-3"><i class="fas fa-quote-right"></i> Repost</a>
                  <%= link_to "View post", community_post_path(@post.community, @post), class: "pl-2" %>
                  <%= link_to user_post_path(@post.user, @post), class: "pl-2" do %>
                    <i class="fas fa-trash-alt"></i>
                  <% end %>
                <% else %>
                  in Global <a href="#modalPostForm" class="pl-3" data-toggle="modal" data-id="<%= @post.id %>"><i class="fas fa-comment-dots"></i> Reply</a><a class="pl-3"><i class="fas fa-quote-right"></i> Repost</a>
                  <%= link_to "View post", user_post_path(@post.user, @post), class: "pl-2" %>
                  <%= link_to user_post_path(@post.user, @post), class: "pl-2" do %>
                    <i class="fas fa-trash-alt"></i>
                  <% end %>
                <% end %>
              </small>
            </div>
          </div>
        </div>
        <%= render partial: "posts/reply_block", locals: {post: @post.replies} %>
      </section>
    </div>
  </div>
</div>

